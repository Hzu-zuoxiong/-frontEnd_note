# HTTP 协议

## HTTP 的主要特点：

- 简单快捷：每个资源的 URI 固定
- 灵活：通过一个 HTTP，可以通过不同数据类型的传输
- 无连接：连接一次就会断开，不会保持连接
- 无状态：单从 HTTP 协议上，服务器不能区别两次连接者的身份

## HTTP 报文的组成部分

![](/assets/HTTP报文.png)

## HTTP 方法：

- GET：获取资源

- POST：传输资源

- PUT：更新资源

- DELETE：删除资源

- HEAD：获得报文首部

## POST 和 GET 的区别：

- GET 在浏览器回退时是无害的，而 POST 会再次提交请求
- GET 产生的 URL 地址可以被收藏，而 POST 不可以
- GET 请求被会浏览器主动缓存，而 POST 不会，除非手动设置
- GET 请求只能进行 url 编码，而 POST 支持多种编码方式
- GET 请求参数会被完整保留在浏览器历史记录里，而 POST 中的参数不会被保留
- GET 请求在 URL 中传送的参数是有长度限制的，而 POST 没有限制
- 对参数的数据类型，GET 只接受 ASCII 字符，而 POST 没有限制
- GET 比 POST 更不安全，因为参数直接暴露在 URL 上，所以不能用来传递敏感信息
- GET 参数通过 URL 传递，POST 放在 Request body 中

## HTTP 状态码

- 1XX：指示信息，表示请求已接受，继续处理
- 2XX：成功，表示请求已被成功接收（200、206）

- 3XX：重定向，要完成请求必须进行更进一步的操作（301、302、304）

- 4XX：客户端错误：请求有语法错误或请求无法实现（400、401、403、404）

- 5XX：服务器错误：服务器未能实现合法的请求（500、503）

## HTTP 发展史

### HTTP/0.9

- 只有一个命令 GET
- 响应类型：仅超文本
- 没有 header 等描述数据的信息
- 服务端发送完毕，就关闭 TCP 连接

### HTTP/1.0

- 增加了很多命令（POST HEAD）
- 增加 status code 和 header
- 多字符集支持、多部分发送、权限、缓存等
- 响应：不再只限于超文本（Content-Type 头部提供了传输 HTML 之外文件的能力---如脚本、样式或媒体文件）

### HTTP/1.1

- 持久连接：TCP 三次握手会在任何连接建立之前发生依次。最终，当发送了所有的数据之后，服务器发送一个消息，表示不会再有更多数据向客户端发送了；则客户端才会关闭连接（断开 TCP）
- 支持的方法：GET、HEAD、POST、PUT、DELETE、TRACE、OPTIONS
- 进行了重大的性能优化和特性增强，分块传输、压缩/解压、内容缓存磋商、虚拟主机（有单个 IP 地址的主机具有多个域名）、更快的响应以及通过增加缓存节省了更多的带宽

### HTTP2

- 所有数据以二进制传输。HTTP1.x 是基于文本的，无法保证健壮性，HTTP2.0 使用新的二进制格式、方便且健壮
- 同一个连接里面发送多个请求不再需要按照顺序来
- 头信息压缩以及推送等提高效率的功能

## HTTPS

HTTPS 与 HTTP 的区别主要为以下四点：

1. HTTPS 协议需要到 CA 申请证书，一般需要缴费。
2. HTTP 是超文本传输协议，信息是明文传输，HTTPS 则是具有安全性的 SSL 加密传输协议。
3. HTTP 和 HTTPS 使用的是完全不同的连接方式，用的端口也不一样，前者是 80 端口，后者是 443 端口。
4. HTTP 的连接很简单，是无状态的；HTTPS 协议是由 SSL+HTTP 协议构建的可进行加密传输，身份认证的网络协议，更安全。

## 持久链接

HTTP 协议采用的是”请求-应答“模式，当使用普通模式（非 Keep-Alive 模式），每个请求/应答客户和服务器都要重新建一个连接，完成之后立即断开连接（HTTP 为无连接协议）。

当使用 Keep-Alive 模式时，Keep-Alive 功能使客户端到服务器端的连接有效，当出现对服务器的后继请求时，Keep-Alive 功能避免了建立或者重新建立连接。

## 管线化

在使用持久链接的情况下，某个链接的消息传递类似于：请求 1 -&gt; 响应 1 -&gt; 请求 2 -&gt; 响应 2 -&gt; 请求 3 -&gt; 响应 3

管线化使某个链接的消息变成：请求 1 -&gt; 请求 2 -&gt; 请求 3 -&gt; 响应 1 -&gt; 响应 2 -&gt; 响应 3

1. 管线化机制通过持久链接完成，仅 HTTP/1.1 支持
2. 只有 GET 和 HEAD 请求可以管线化，而 POST 有所限制
3. 初次创建链接时不应启动管线机制，因为对方（服务器）不一定支持 HTTP/1.1 协议
4. HTTP/1.1 要求服务器端支持管线化，但不要求服务器端也对响应进行管线化处理，只是要求对于管线化的请求不失败即可
5. 管线化不会影响响应到来的顺序
